<!DOCTYPE html>
<html lang="ko">

<head>

  <title>bank X</title>
  <meta charset="UTF-8">
  <meta http-equiv="X-UA-Compatible" content="IE=edge">
  <meta name="viewport"
    content="width=device-width, initial-scale=1.0, maximum-scale=1.0, minimum-scale=1.0, user-scalable=no" />
  <meta name="title" content="bank X" />
  <meta property="og:type" content="website">
  <meta property="og:title" content="bank X">
  <meta property="og:description" content="bank X" />

  <!-- TODO: library -->
  <script src="./resources/js/lib/jquery.min.js"></script>
  <script src="./resources/js/lib/jquery-ui.js"></script>
  <link rel="stylesheet" href="./resources/css/lib/jquery-ui.css">
  <!-- 1114 라이브러리 추가 -->
  <script src="./resources/js/lib/slick.js"></script>
  <link rel="stylesheet" href="./resources/css/lib/slick.css">

  <!-- TODO: import -->
  <link rel="stylesheet" href="./resources/css/lib/swiper.min.css">
  <script src="./resources/js/lib/swiper.min.js"></script>
  <link rel="stylesheet" href="./resources/css/style.css" type="text/css">
  <script src="./resources/js/scripts.js"></script>
  <script type="text/javascript" src="./resources/js/util.js"></script>

  <!--[if lt IE 9]>
  <script src="./resources/js/lib/html5shiv.js"></script>
  <script src="./resources/js/lib/placeholders.js"></script>
  <![endif]-->

  <!-- JSTL -->
</head>
<script type="text/javascript">
  /**
   * 페이지 로드시 처리해야할 스크립트 정의
   */
  $(function () {
    //인증코드 확인 버튼 활성화
    $('#otp_code').on("change paste keyup", function () {
      var authCode = $(this).val();
      var confirmBtn = document.getElementById('otp_confirm');
      if (authCode.length === 6) {
        confirmBtn.disabled = false;
      } else {
        confirmBtn.disabled = 'disabled';
      }
    })
  })
  /**
   * 화면 이동
   * @param url 이동할 url
   */
  function moveUrl(url) {
    window.location = url;
  }
  /**
   * 복사하기
   */
  function copyToClipboard() {
    var dummy = document.createElement("textarea");
    document.body.appendChild(dummy);
    dummy.value = 'RPCG3LDK5XDQKJSM';
    dummy.select();
    document.execCommand('copy');
    document.body.removeChild(dummy);
    showSuccessPopup("Copied to clipboard.");
  }

  /**
   * 구글 otp 인증코드 확인
   */
  function confirmOTP() {
    $.ajax({
      type: 'POST',
      url: '/verify/otpCheck',
      data: $('#otp_frm').serialize(),
      dataType: 'json',
      success: function (res) {
        if (ajaxResponse(res) && res.body.result == '0000') {
          alert("Success!");
          moveUrl('/verify');
        } else {
          alert("FAIL!");
        }
      },
      error: function (res) {
        showErrorPopup('Error : 관리자에게 문의하세요');
      }
    })
  }
</script>

<body class="white">
  <div id="wrap">
    <header>
      <div class="app-inner">
        <div class="cont-operation">
          <p class="txt-intro">
            <a href="javascript:moveUrl('/verify')">
              <span class="ico ico-back">back</span>
            </a>
          </p>
        </div>
        <a class="btn-gnb" href="#">Menu</a>
      </div>
      <!-- gnb 화면 -->

      <script type="text/javascript">
        $(function () {
          modalUi();
        })

        function loginOut() {
          window.location = "/logout";
        }

        function checkLevel(url) { //  UserVO vo = (UserVO)session.getAttribute("LOGIN");
          $('#close_btn').trigger("click");
          var level = "1";
          var move = false;
          if (level == '2') {
            move = true;
          }
          if (move) {
            if (!isEmpty(url)) {
              window.location = url;
            }
          } else {
            //alert('Please complete Lv.2 verification for using this service');
            //이동 실패
            var message = $('#message');
            var html = '<p>';
            html += '보안레벨 2단계 인증을 완료해야 출금이 가능합니다.';
            html += '</p>';
            message.html(html);
            $('#error').trigger("click");
          }
        }

        function checkLevel1(url, returnUrl) {
          $('#close_btn').trigger("click");
          var level = "1";
          var move = false;
          if (level == '2') {
            move = true;
          }
          if (move) {
            if (!isEmpty(url)) {
              window.location = url;
            }
          } else {
            //alert('Please complete Lv.2 verification for using this service');
            //이동 실패
            var message = $('#message');
            var html = '<p>';
            html += '보안레벨 2단계 인증을 완료해야 출금이 가능합니다.';
            html += '</p>';
            message.html(html);
            $('.ok-hide').attr('onclick', 'location.href="' + returnUrl + '"');
            $('#error').trigger("click");
          }
        }

        /**
         * 에러 팝업 생성
         * @param msg
         */
        function showErrorPopup(msg) {
          //alert('Please complete Lv.2 verification for using this service');
          $('#modal-message').text(msg);
          $('#error').trigger("click");
        }

        function showSuccessPopup(title, msg) {
          $('#ok_title').text(title);
          $('#ok_message').text(msg);
          $('#show_ok').trigger("click");
        }
      </script>
      <div class="gnb-container">
				<div class="gnb-header">
					<div class="user-info">
						안녕하세요!<br />
						<span class="user-account">test@pocketmobile.co.kr</span> 님
					</div>
					<div class="user-modify">
						<div>보안 <span>1레벨</span></div>
						<a href="/account">정보수정</a>
					</div>
					<div class="nav-ctl">
						<a class="ico ico-close" href="#" id="close_btn">Close</a>
					</div>
				</div>
				<div class="gnb-body">
					<ul class="menu">
						<li><a href="#">서비스 이용약관</a></li>
						<li><a href="#">개인정보 보호 정책</a></li>
					</ul>
				</div>
				<div class="gnb-footer">
					<a href="/logout" class="btn gray">로그아웃</a>
					<a href="/support?type=1" class="customer">bank X customer center</a>
				</div>
			</div>
      <a class="agree-btn modalLoad" href="#error_popup" style="display: none" id="error"> test</a>
      <a class="agree-btn modalLoad" href="#ok_popup" style="display: none" id="show_ok"> test</a>
      <!-- #wrap e -->
      <!-- error popup -->
      <div class="modal" id="error_popup">
        <div class="modal-inner">
          <div class="modal-header">
            <p>
              <img src="./resources/images/img-notice.png" alt="" style="width:17px;height:17px;bottom:0px">
              <em class="red">Notice</em>
            </p>
          </div>

          <div class="modal-body">
            <div class="modal-cont" id="message">
              <p id="modal-message">
                This CFD Product is upcoming.<br />
                Please wait this Product.
              </p>
            </div>
          </div>

          <div class="modal-footer">
            <div class="row">
              <div class="column">
                <a class="btn negative ok-hide" href="#">OK</a>
              </div>
            </div>
          </div>


          <div class="modal-controller">
            <a href="#" class="ico ico-close">close</a>
          </div>
        </div>
      </div>
      <!-- one button confirm popup -->
      <div class="modal" id="ok_popup">
        <div class="modal-inner">
          <div class="modal-header">
            <p>
              <em class="blue" id="ok_title">Change Your Password</em>
            </p>
          </div>

          <div class="modal-body">
            <div class="modal-cont">
              <p id="ok_message">
              </p>
            </div>
          </div>

          <div class="modal-footer">
            <div class="row">
              <div class="column">
                <a class="btn ico-close" href="#" id="ok_popup_confirm">OK</a>
              </div>
            </div>
          </div>
        </div>
      </div>
    </header>
    <div id="container">
      <section class="app-section">
        <div class="app-inner">
          <div class="info-container vertical-layout">
            <div class="vertical-layout-inner">
              <h3 class="otp">OTP 설정</h3>
              <p>OTP인증을 위해 아래 스토어에서 앱을 설치하세요.</p>
            </div>
          </div>
          <div class="row btn-row pb15 pt15">
            <div class="column"><a href="https://play.google.com/store/apps/details?id=com.google.android.apps.authenticator2" target="_blank"><img src="./resources/images/btn-googlePlay.png" alt="app store"></a></div>
            <div class="column"><a href="https://itunes.apple.com/app/google-authenticator/id388497605" target="_blank"><img src="./resources/images/btn-appStore.png" alt="app store"></a></div>
          </div>
        </div>
        <hr class="section-space" />
        <div class="app-inner">
          
          <form id="otp_frm">
            <div class="qr-code-box">
              <div class="title">OTP 등록 코드</div>
              <div class="img-box">
                <img id="qr_img"
                  src="https://chart.googleapis.com/chart?chs=300x300&chld=M&cht=qr&chl=otpauth%3A%2F%2Ftotp%2FPRIME%28test%40pocketmobile.co.kr%29%3Fsecret%3DRPCG3LDK5XDQKJSM"
                  alt="">
              </div>

              <div class="input type-btn">
                <input id="secret_key" type="text" name="otpNumber" value="RPCG3LDK5XDQKJSM" readonly=""
                  style="width: calc(100% - 94px);">
                <a class="btn" href="javascript:copyToClipboard()">복사</a>
              </div>
            </div>
            <div class="form-group">
              <div class="form-line">
                <div class="input">
                  <label>OTP 인증코드</label>
                  <!-- 기본 -->
                  <div class="confirm-input">
                    <input id="otp_code" type="text" name="otpCode" value="" placeholder="6자리 OTP인증코드를 입력하세요.">
                  </div>
                  <!-- class 기존에러 input.invalid에서 상위요소에 .fail 추가해주세요 -->
                  <!-- class .com 완료  -->
                </div>
              </div>
            </div>
          </form>
          <div class="button">
            <!-- input .com일 경우 disabled 해제 -->
            <button id="otp_confirm" class="btn" disabled onclick="confirmOTP()">확인</button>
          </div>
        </div>
      </section>
    </div>
  </div>
</body>

</html>